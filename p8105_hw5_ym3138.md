HW5
================
Yuwei Ma

## Problem 1

``` r
library(tidyverse)
library(dplyr)
library(ggplot2)
library(readxl)
knitr::opts_chunk$set(
  fig.width = 6,
  fig.asp = .6,
  out.width = "90%"
)
```

Build function

``` r
# Function to test whether a group has at least one shared birthday

birthday_dup <- function(n) {
birthdays <- sample(1:365, n, replace = TRUE)
any(duplicated(birthdays))
}
```

Simulation

``` r
set.seed(123)  # ensures reproducibility

group_sizes <- 2:50
num_runs <- 10000

prob_shared <- numeric(length(group_sizes))

for (i in seq_along(group_sizes)) {
n <- group_sizes[i]
results <- replicate(num_runs, birthday_dup(n))
prob_shared[i] <- mean(results)
}

prob_shared
```

    ##  [1] 0.0033 0.0079 0.0158 0.0248 0.0387 0.0570 0.0749 0.0885 0.1160 0.1402
    ## [11] 0.1665 0.1958 0.2228 0.2578 0.2824 0.3105 0.3434 0.3750 0.4079 0.4388
    ## [21] 0.4747 0.5067 0.5301 0.5644 0.5958 0.6226 0.6564 0.6871 0.7088 0.7246
    ## [31] 0.7537 0.7753 0.7959 0.8147 0.8331 0.8494 0.8693 0.8803 0.8905 0.9040
    ## [41] 0.9146 0.9216 0.9335 0.9434 0.9471 0.9537 0.9627 0.9669 0.9710

Plot

``` r
plot(group_sizes, prob_shared, type = "l", lwd = 2,
xlab = "Group Size (n)",
ylab = "Probability of Shared Birthday",
main = "Birthday Problem Simulation",
cex.lab = 1.3, cex.axis = 1.2, cex.main = 1.4)

grid()
```

<img src="p8105_hw5_ym3138_files/figure-gfm/unnamed-chunk-4-1.png" width="90%" />

Comment on the Results

The simulation reproduces the well-known birthday paradox:

- The probability rises slowly for small groups, but increases rapidly
  after around 20 people.

- At 23 people, the probability of a shared birthday is close to 50%.

- By the time the group reaches 50 people, the probability is above 90%.

This result is counterintuitive because most people expect that a much
larger group is needed for such a high probability. The paradox arises
because we compare all possible pairs within the group, and the number
of pairs grows quadratically with group size.
